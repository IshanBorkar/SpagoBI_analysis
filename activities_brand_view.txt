select `division`.`name` AS `divnm`,`activities_brand_summary`.`crmuniqueno` AS `crmuniqueno`,`activities_brand_summary`.`zone` AS `zone`,`districts`.`districtname` AS `districtname`,`activities_brand_summary`.`headquarter` AS `headquarter`,`activities_brand_summary`.`territory` AS `territory`,`activities_brand_summary`.`name` AS `name`,`activities_brand_summary`.`contactid` AS `sbucode`,`activities_brand_summary`.`contactname` AS `contactname`,`activities_brand_summary`.`qualificationname` AS `qualificationname`,`activities_brand_summary`.`speciality` AS `speciality`,`activities_brand_summary`.`frequencyname` AS `frequencyname`,`activities_brand_summary`.`doc_status` AS `doc_status`,`activities_brand_summary`.`activity_nm` AS `activity_nm`,`activities_brand_summary`.`act_date` AS `act_date`,`activities_brand_summary`.`act_status` AS `act_status`,`activities_brand_summary`.`amt` AS `amount`,`activities_brand_summary`.`brand1` AS `brand1`,`activities_brand_summary`.`current_value1` AS `current_value1`,`activities_brand_summary`.`expected_value1` AS `expected_value1`,`activities_brand_summary`.`brand2` AS `brand2`,`activities_brand_summary`.`current_value2` AS `current_value2`,`activities_brand_summary`.`expected_value2` AS `expected_value2`,`activities_brand_summary`.`brand3` AS `brand3`,`activities_brand_summary`.`current_value3` AS `current_value3`,`activities_brand_summary`.`expected_value3` AS `expected_value3`,`activities_brand_summary`.`brand4` AS `brand4`,`activities_brand_summary`.`current_value4` AS `current_value4`,`activities_brand_summary`.`expected_value4` AS `expected_value4`,`activities_brand_summary`.`brand5` AS `brand5`,`activities_brand_summary`.`current_value5` AS `current_value5`,`activities_brand_summary`.`expected_value5` AS `expected_value5`, `activities_brand_summary`.`quantity` AS `quantity` ,`activities_brand_summary`.`name_of_book_equipment_printing` AS `name_of_book_equipment_printing`from ((((`activities_brand_summary` join `users` on((`activities_brand_summary`.`bo` = `users`.`id`))) join `patches` on((`users`.`patch` = `patches`.`patchid`))) left join `districts` on((`patches`.`districtid` = `districts`.`districtid`))) join `division` on((`users`.`division` = `division`.`divisionid`))) order by `division`.`name`




SELECT DISTINCT   summary_userwise_dcrs_rxvalue.empname,summary_userwise_dcrs_rxvalue.empcode,summary_userwise_dcrs_rxvalue.zonecode,summary_userwise_dcrs_rxvalue.zonename,summary_userwise_dcrs_rxvalue.patchsapcode,summary_userwise_dcrs_rxvalue.patchname,p1.id,p1.reports_to_id,p1.profileid,summary_userwise_dcrs_rxvalue.sbucode,summary_userwise_dcrs_rxvalue.doc_nam,summary_userwise_dcrs_rxvalue.specialityname,summary_userwise_dcrs_rxvalue.rx_brand,summary_userwise_dcrs_rxvalue.productbrandtypeid,summary_userwise_dcrs_rxvalue.`month`,summary_userwise_dcrs_rxvalue.`year`,summary_userwise_dcrs_rxvalue.qty_text as prescribe,summary_userwise_dcrs_rxvalue.scope as scope,summary_userwise_dcrs_rxvalue.rccval from summary_userwise_dcrs_rxvalue INNER JOIN  (SELECT DISTINCT empname,empcode,zonecode,zonename,patchsapcode,patchname,users.id,users.reports_to_id,role2profile.profileid,sbucode,doc_nam,specialityname,summary_userwise_dcrs_rxvalue.rx_brand,month,year,qty_text as prescribe,scope as scope,rccval,max(summary_userwise_dcrs_rxvalue.date) as maxdate,productbrandtypeid  from summary_userwise_dcrs_rxvalue inner join users on users.employeecode = summary_userwise_dcrs_rxvalue.empcode INNER JOIN contactdetails on summary_userwise_dcrs_rxvalue.sbucode = contactdetails.contactid  inner join user2role on users.id=user2role.userid inner join role2profile on user2role.roleid = role2profile.roleid	where users.division='14' and year='2016' and profileid IN (5) and  users.rx_type='Regular' and users.id IN("1773") and contactdetails.deleted = 0 GROUP BY users.id,month,year,sbucode,productbrandtypeid ORDER BY zonename,patchsapcode,doc_nam asc)p1 on (summary_userwise_dcrs_rxvalue.`month` = p1.`month` and summary_userwise_dcrs_rxvalue.`year` = p1.`year` and summary_userwise_dcrs_rxvalue.sbucode = p1.sbucode and summary_userwise_dcrs_rxvalue.productbrandtypeid = p1.productbrandtypeid and summary_userwise_dcrs_rxvalue.date = p1.maxdate)



select `summary_userwise_dcrs_rxvalue`.`zone` AS `zone`,`summary_userwise_dcrs_rxvalue`.`territorycode` AS `territorycode`,`summary_userwise_dcrs_rxvalue`.`territory` AS `territory`,`summary_userwise_dcrs_rxvalue`,`employeecode` AS `employeecode`,`summary_userwise_dcrs_rxvalue`.`PSR name` AS `PSR name`,`activities_brand_summary`.`territory` AS `territory`,`activities_brand_summary`.`name` AS `name`,`activities_brand_summary`.`contactid` AS `sbucode`,`activities_brand_summary`.`contactname` AS `contactname`,`activities_brand_summary`.`qualificationname` AS `qualificationname`,`activities_brand_summary`.`speciality` AS `speciality`,`activities_brand_summary`.`frequencyname` AS `frequencyname`,`activities_brand_summary`.`doc_status` AS `doc_status`,`activities_brand_summary`.`activity_nm` AS `activity_nm`,`activities_brand_summary`.`act_date` AS `act_date`,`activities_brand_summary`.`act_status` AS `act_status`,`activities_brand_summary`.`amt` AS `amount`,`activities_brand_summary`.`brand1` AS `brand1`,`activities_brand_summary`.`current_value1` AS `current_value1`,`activities_brand_summary`.`expected_value1` AS `expected_value1`,`activities_brand_summary`.`brand2` AS `brand2`,`activities_brand_summary`.`current_value2` AS `current_value2`,`activities_brand_summary`.`expected_value2` AS `expected_value2`,`activities_brand_summary`.`brand3` AS `brand3`,`activities_brand_summary`.`current_value3` AS `current_value3`,`activities_brand_summary`.`expected_value3` AS `expected_value3`,`activities_brand_summary`.`brand4` AS `brand4`,`activities_brand_summary`.`current_value4` AS `current_value4`,`activities_brand_summary`.`expected_value4` AS `expected_value4`,`activities_brand_summary`.`brand5` AS `brand5`,`activities_brand_summary`.`current_value5` AS `current_value5`,`activities_brand_summary`.`expected_value5` AS `expected_value5`,`activities_brand_summary`.`quantity` AS `quantity`,`activities_brand_summary`.`name_of_book_equipment_printing` AS `name_of_book_equipment_printing` from ((((`activities_brand_summary` join `users` on((`activities_brand_summary`.`bo` = `users`.`id`))) join `patches` on((`users`.`patch` = `patches`.`patchid`))) left join `districts` on((`patches`.`districtid` = `districts`.`districtid`))) join `division` on((`users`.`division` = `division`.`divisionid`))) order by `division`.`name`

